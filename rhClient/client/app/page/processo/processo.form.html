<div class="page" ng-controller="processoFormCtrl">
    <div class="row ui-section">
        <div class="col-lg-8 clearfix">
            <h2 class="section-header">{{!detalhes ? 'Formulário Processo' : 'Detalhes Processo'}}</h2>
        </div>
        <div class="col-md-12">
            <div class="panel panel-default">
                <div class="panel-body">
                    <div class="col-lg-12">
                        <form ng-disabled="detalhes" name="processoForm" ng-submit="save()">
                            <md-tabs md-dynamic-height md-border-bottom>
                                <md-tab label="Dados Cadastrais Complementares">
                                    <md-content class="md-padding">
                                        <div layout="column" ng-cloak class="md-inline-form inputdemoBasicUsage">
                                            <div layout-padding>
                                                <div class="row">
                                                    <div layout class="col-lg-2" layout-sm="colum">
                                                        <md-input-container flex>
                                                            <label>Matrícula</label>
                                                            <input ng-disabled="detalhes" readonly="true" ng-model="funcionario.matricula"
                                                                name="matricula">
                                                        </md-input-container>
                                                    </div>
                                                    <div class="col-lg-5" layout-sm="column">
                                                        <md-autocomplete ng-disabled="detalhes || processo.id !=null"
                                                            md-input-name="autocompleteField"
                                                            ng-required="true" md-no-cache="noCache"
                                                            md-floating-label="Funcionário" md-selected-item="funcionario"
                                                            md-search-text="searchFuncionario"
                                                            md-items="funcionario in querySearchFuncionario(searchFuncionario)" md-item-text="funcionario.nome"
                                                            md-delay="100"
                                                            md-min-length="3"
                                                            md-selected-item-change="funcionarioSelect()">
                                                            <md-item-template>
                                                                <div>{{funcionario.matricula}} - {{funcionario.nome}}</div>
                                                            </md-item-template>
                                                        </md-autocomplete>
                                                    </div>
                                                    <div layout class="col-lg-5" layout-sm="colum">
                                                        <md-input-container flex>
                                                            <label>Empresa</label>
                                                            <input ng-disabled="detalhes" readonly="true" ng-model="funcionario.empresa.nomeFilial"
                                                                name="empresaNome">
                                                        </md-input-container>
                                                    </div>

                                                </div>


                                                <div class="row">
                                                    <div layout class="col-lg-4" layout-sm="colum">
                                                        <md-input-container flex>
                                                            <label>Número do Processo</label>
                                                            <input ng-disabled="detalhes || processo.id !=null" required ng-model="processo.numeroProcesso"
                                                                name="filialNome">
                                                        </md-input-container>
                                                    </div>
                                                    <div layout class="col-lg-6" layout-sm="colum">
                                                        <md-input-container flex>
                                                            <label>Assunto</label>
                                                            <input ng-disabled="detalhes" required ng-model="processo.assunto"
                                                                name="filialNome">
                                                        </md-input-container>
                                                    </div>
                                                    <div class="col-lg-2" layout-sm="column">
                                                        <md-switch style="float: right" ng-disabled="detalhes || processo.id !=null" md-invert
                                                            ng-model="processo.impactoFinanceiro" aria-label="Impacto Financeiro">
                                                            Impacto Financeiro
                                                        </md-switch>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div layout class="col-md-3" layout-sm="column">
                                                        <md-input-container flex>
                                                            <label>Data Inicio</label>
                                                            <md-icon class="material-icons icon-momentpicker" ng-class="md-datepicker-calendar-icon"
                                                                aria-label="md-calendar">date_range</md-icon>
                                                            <input required name="dataInicio" moment-picker="processo.dataInicio"
                                                                placeholder="Selecione"
                                                                ng-model="processo.dataInicio" format="DD/MM/YYYY" locale="pt-br" start-view="month"
                                                                ng-model-options="{ updateOn: 'blur' }" ng-disabled="detalhes">
                                                        </md-input-container>
                                                    </div>
                                                    <div layout class="col-md-3" layout-sm="column">
                                                        <md-input-container flex>
                                                            <label>Data Fim</label>
                                                            <md-icon class="material-icons icon-momentpicker" ng-class="md-datepicker-calendar-icon"
                                                                aria-label="md-calendar">date_range</md-icon>
                                                            <input name="dataInspecao" moment-picker="processo.dataFim"
                                                                placeholder="Selecione"
                                                                ng-model="processo.dataFim" format="DD/MM/YYYY" locale="pt-br" start-view="month"
                                                                ng-model-options="{ updateOn: 'blur' }" ng-disabled="detalhes">
                                                        </md-input-container>
                                                    </div>
                                                    <div layout class="col-md-6" layout-sm="colum">
                                                        <md-input-container flex>
                                                            <label>Requerente</label>
                                                            <input ng-model="processo.requerente" name="valor">
                                                        </md-input-container>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div layout class="col-md-3" layout-sm="column">
                                                        <md-input-container flex>
                                                            <label>Ato/Portaria</label>
                                                            <input type="number" ng-model="processo.atoPortaria" name="valor">
                                                        </md-input-container>
                                                    </div>
                                                    <div layout class="col-md-3" layout-sm="column">
                                                        <md-input-container flex>
                                                            <label>Data do ato</label>
                                                            <md-icon class="material-icons icon-momentpicker" ng-class="md-datepicker-calendar-icon"
                                                                aria-label="md-calendar">date_range</md-icon>
                                                            <input required name="periodoInicial" moment-picker="processo.dataAto"
                                                                placeholder="Selecione"
                                                                ng-model="processo.dataAto" format="DD/MM/YYYY" locale="pt-br"
                                                                start-view="month"
                                                                ng-model-options="{ updateOn: 'blur' }" ng-disabled="detalhes">
                                                        </md-input-container>
                                                    </div>
                                                    <div layout class="col-md-3" layout-sm="column">
                                                        <md-input-container flex>
                                                            <label>DOE</label>
                                                            <input ng-model="processo.doe" name="valor">
                                                        </md-input-container>
                                                    </div>
                                                    <div layout class="col-md-3" layout-sm="column">
                                                        <md-input-container flex>
                                                            <label>Data DOE</label>
                                                            <md-icon class="material-icons icon-momentpicker" ng-class="md-datepicker-calendar-icon"
                                                                aria-label="md-calendar">date_range</md-icon>
                                                            <input name="periodoFinal" moment-picker="processo.dataDoe" placeholder="Selecione"
                                                                ng-model="processo.dataDoe" format="DD/MM/YYYY" locale="pt-br" start-view="month"
                                                                ng-model-options="{ updateOn: 'blur' }" ng-disabled="detalhes">
                                                        </md-input-container>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div layout class="col-lg-3" layout-sm="colum">
                                                        <md-input-container flex>
                                                            <label>Situação</label>
                                                            <md-select required ng-disabled="detalhes" name="situacao"
                                                                ng-model="processo.situacao">
                                                                <md-option ng-repeat="s in situacoes" value="{{s.label}}">
                                                                    {{s.label}}
                                                                </md-option>
                                                            </md-select>
                                                        </md-input-container>
                                                    </div>
                                                    <div layout class="col-md-3" layout-sm="column">
                                                        <md-input-container flex>
                                                            <label>Início Impacto Financeiro</label>
                                                            <md-icon class="material-icons icon-momentpicker" ng-class="md-datepicker-calendar-icon"
                                                                aria-label="md-calendar">date_range</md-icon>
                                                            <input ng-required="processo.impactoFinanceiro" name="periodoInicial"
                                                                moment-picker="processo.inicioImpactoFinanco"
                                                                placeholder="Selecione"
                                                                ng-model="processo.inicioImpactoFinanco" format="DD/MM/YYYY" locale="pt-br"
                                                                start-view="month"
                                                                ng-model-options="{ updateOn: 'blur' }" ng-disabled="detalhes || !processo.impactoFinanceiro ||
                                                                processo.id !=null">
                                                        </md-input-container>
                                                    </div>
                                                    <div layout class="col-md-3" layout-sm="column">
                                                        <md-input-container flex>
                                                            <label>Fim Impacto Financeir</label>
                                                            <md-icon class="material-icons icon-momentpicker" ng-class="md-datepicker-calendar-icon"
                                                                aria-label="md-calendar">date_range</md-icon>
                                                            <input ng-required="processo.impactoFinanceiro" name="periodoInicial"
                                                                moment-picker="processo.fimImpactoFinanco"
                                                                placeholder="Selecione"
                                                                ng-model="processo.fimImpactoFinanco" format="DD/MM/YYYY" locale="pt-br"
                                                                start-view="month"
                                                                ng-model-options="{ updateOn: 'blur' }" ng-disabled="detalhes || !processo.impactoFinanceiro ||
                                                                processo.id !=null">
                                                        </md-input-container>
                                                    </div>
                                                    <div layout class="col-lg-3" layout-sm="colum">
                                                        <md-input-container flex>
                                                            <label>Tipo de reflexo</label>
                                                            <md-select ng-required="processo.impactoFinanceiro" ng-disabled="detalhes || !processo.impactoFinanceiro || processo.id !=null" name="afastamento"
                                                                ng-model="processo.tipoReflexo">
                                                                <md-option ng-repeat="reflexo in reflexos" value="{{reflexo.label}}">
                                                                    {{reflexo.label}}
                                                                </md-option>
                                                            </md-select>
                                                        </md-input-container>
                                                    </div>
                                                </div>

                                                <h2 class="md-title">Lista de anexos</h2>
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <div class="panel panel-default">
                                                            <div class="panel-body">
                                                                <article class="article">
                                                                    <md-card class="no-margin-h">
                                                                        <div class="col-md-12">
                                                                            <form ng-disabled="detalhes" enctype="multipart/form-data" name="formAnexar">
                                                                                <div ng-if="!detalhes" class="row">
                                                                                    <div class="col-md-10" layout layout-sm="column">
                                                                                        <md-input-container flex>
                                                                                            <input type="file" id="anexo-file" name="file"
                                                                                                ng-file="getFile($file)" />
                                                                                        </md-input-container>
                                                                                    </div>
                                                                                    <div class="col-md-2" layout-sm="column">
                                                                                        <md-input-container>
                                                                                            <md-button ng-click="showConfirm($event)"
                                                                                                class="md-raised
                                                                                                md-primary">Anexar</md-button>
                                                                                        </md-input-container>
                                                                                    </div>
                                                                                </div>
                                                                            </form>
                                                                        </div>
                                                                        <md-table-container>
                                                                            <table md-table ng-model="selected" md-progress="promise">
                                                                                <thead ng-if="!options.decapitate" md-head md-order="query.order"
                                                                                    md-on-reorder="loadList">
                                                                                    <tr md-row>
                                                                                        <th md-column md-order-by="nome">
                                                                                            <span>Nome Documento</span>
                                                                                        </th>
                                                                                        <th md-column md-order-by="nome">
                                                                                            <span>Data de Anexo</span>
                                                                                        </th>
                                                                                        <th md-column md-order-by="nome">
                                                                                            <span>Tipo de Arquivo</span>
                                                                                        </th>
                                                                                        <th ng-if="!detalhes" md-column>
                                                                                            <span>Ações</span>
                                                                                        </th>
                                                                                    </tr>
                                                                                </thead>
                                                                                <tbody md-body>
                                                                                    <tr md-row md-select="item" md-select-id="item" md-auto-select
                                                                                        ng-repeat="item in anexos">
                                                                                        <td md-cell>{{item.fileName}}</td>
                                                                                        <td md-cell>{{item.createdAt | date:'dd/MM/yy'}}</td>
                                                                                        <td md-cell>{{item.fileType}}</td>
                                                                                        <td md-cell ng-if="!detalhes">
                                                                                            <a href="" ng-if="!detalhes"
                                                                                                ng-click="removeAnexo(item.id)">
                                                                                                <md-tooltip md-direction="top">Excluir</md-tooltip>
                                                                                                <i class="fa fa-trash-o fa-lg"></i>
                                                                                            </a>
                                                                                        </td>
                                                                                    </tr>
                                                                                </tbody>
                                                                            </table>
                                                                        </md-table-container>

                                                                    </md-card>
                                                                </article>

                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>


                                                <div ng-if="detalhes" layout layout-sm="column">
                                                    <table md-table md-progress="promise">
                                                        <thead md-head>
                                                            <tr md-row>
                                                                <th md-column>
                                                                    <span>Criado em:</span>
                                                                </th>
                                                                <th md-column>
                                                                    <span>Atualizado em:</span>
                                                                </th>
                                                                <th md-column>
                                                                    <span>Criado por:</span>
                                                                </th>
                                                                <th md-column>
                                                                    <span>Atualizado por:</span>
                                                                </th>
                                                            </tr>
                                                        </thead>
                                                        <tbody md-body>
                                                            <tr md-row>
                                                                <td md-cell>{{processo.criadoEm | date:'dd/MM/yy - HH:mm'}}</td>
                                                                <td md-cell>{{processo.alteradoEm | date:'dd/MM/yy -
                                                                    HH:mm'}}</td>
                                                                <td md-cell>{{processo.criadoPor}}</td>
                                                                <td md-cell>{{processo.alteradoPor}}</td>

                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-12 text-center">
                                                        <button ng-if="!detalhes" ng-disabled="processoForm.$invalid" type="submit"
                                                            ui-wave class="btn btn-primary btn-w-md">Salvar</button>
                                                        <p class="btn btn-default btn-w-md" ui-wave data-ng-click="goBack()">Voltar</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </md-content>
                                    </md-tab>
                                </md-tabs>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>